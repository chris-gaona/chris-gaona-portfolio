var mongoose=require("mongoose");var crypto=require("crypto");var jwt=require("jsonwebtoken");var UserSchema=new mongoose.Schema({username:{type:String,lowercase:true,required:true,unique:true,trim:true},firstName:{type:String,required:true,trim:true},hash:{type:String,required:true},salt:{type:String,required:true}});UserSchema.methods.setPassword=function(e){this.salt=crypto.randomBytes(16).toString("hex");this.hash=crypto.pbkdf2Sync(e,this.salt,1e3,64).toString("hex")};UserSchema.methods.validPassword=function(e){var r=crypto.pbkdf2Sync(e,this.salt,1e3,64).toString("hex");return this.hash===r};UserSchema.methods.generateJWT=function(){var e=new Date;var r=new Date(e);r.setDate(e.getDate()+60);return jwt.sign({_id:this._id,username:this.username,exp:parseInt(r.getTime()/1e3)},"SECRET")};mongoose.model("User",UserSchema);