"use strict";var express=require("express");var router=express.Router();var mongoose=require("mongoose");var User=mongoose.model("User");var passport=require("passport");router.post("/register",function(e,s,r){if(!e.body.username||!e.body.password){return s.status(400).json({message:"Please fill out all fields"})}if(e.body.password!==e.body.confirmPassword){return s.status(400).json({message:"Uh oh! Passwords do not match"})}var o=new User;o.username=e.body.username;o.firstName=e.body.firstName;o.setPassword(e.body.password);o.save(function(e){if(e){return r(e)}return s.json({token:o.generateJWT()})})});router.post("/login",function(e,s,r){if(!e.body.username||!e.body.password){return s.status(400).json({message:"Please fill out all fields"})}passport.authenticate("local",function(e,o,t){if(e){return r(e)}if(o){return s.json({token:o.generateJWT()})}else{return s.status(401).json(t)}})(e,s,r)});module.exports=router;